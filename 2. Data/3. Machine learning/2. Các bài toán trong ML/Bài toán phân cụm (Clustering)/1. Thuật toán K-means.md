
![](https://contenthub-static.grammarly.com/blog/wp-content/uploads/2025/02/Clustering_Data.png)

**Cụm (Cluster, Voronoi tessallation)** là tập hợp các vector đặc trưng *gần nhau*, thường dựa vào khoảng cách Euclid.
**Phân cụm (clustering)** là phân $N$ vector thành $K<N$ cụm riêng biệt. Nói cách khác, các vector trong cụm có phương sai như nhau.

**Các bước**:
1. Chọn $K$ điểm ngẫu nhiên làm tâm cụm (**centroid**).
2. Phân mỗi vector $\mathbf{x}_i$ vào tâm cụm gần nó nhất.
3. Tính lại tâm cụm mới.
4. Nếu tâm cụm mới giống với tâm cụm cũ thì thuật toán kết thúc.

![](https://storage.googleapis.com/kaggle-media/learn/images/tBkCqXJ.gif)
*Minh họa trực quan quá trình clustering*.

**Hạn chế**:
1. Số lượng cụm cần được xác định trước. Có một phương pháp dự đoán $K$ là **elbow method**.
2. Chất lượng nghiệm phụ thuộc vào cụm khởi tạo ban đầu. Có thể hạn chế nhược điểm này bằng:
	1. Chạy K-means nhiều lần với các centroid ban đầu khác nhau, sau đó chọn nghiệm ít mất mát nhất.
	2. **K-Means++**: Phương pháp chọn centroid tối ưu.
3. Các cụm phải có số lượng điểm cân đối.
4. Các cụm phải có dạng gần cầu.
5. Các cụm phải tách biệt nhau.

VD: Dataset [California housing prices](https://www.kaggle.com/datasets/camnugent/california-housing-prices) bao gồm đặc điểm của rất nhiều ngôi nhà. Ta sẽ thử phân cụm các ngôi nhà dựa trên `MedInc` (Median income), `Latitude` và `Longtitude`:

```python
kmeans = KMeans(n_clusters=6)
X["Cluster"] = kmeans.fit_predict(X)
X["Cluster"] = X["Cluster"].astype("category")

sns.relplot(
    x="Longitude", y="Latitude", hue="Cluster", data=X, height=6,
);
```

![](https://www.kaggleusercontent.com/kf/137493070/eyJhbGciOiJkaXIiLCJlbmMiOiJBMTI4Q0JDLUhTMjU2In0..wM_p27d9Mv5J-7n444I87w.KfzrORecgTIlpd4OcaC80SgeLFv1HPrjuu9ALlFieCP-5IMDzQpQBTG1T5jjszzdgHmQiiDpHvrHu85K2Ts_8g5I2Rt6tvBJksVwS_pRyIw6PwWC7fTCKf0mrD8uHHPoBYq5Ag-2Tml_Y2rOf2Y-pgQnXGjaug9Vqgknxl9YFKp7orMSb8QLijQHtCNFuU76UVZlqioHpV1imTt9xwozAvN4ctg_0E5LCoGl11pXO2_BInh5YsccoIm3ajtYn_icJudR5Pdw6QxS8AX6AWUvX7GTpNoIJvZ7nhjiKxCoPKasIbtjuZWcfCSnfHTUAO99Vbd0-2PS-wPeFeysD9q-nvUzUsZpmqmj7ToEXrblRMnY8HdUoLvU_j2NQrAusQE7JB5jO8AcPmCfFnT0tMEWxiJyXcnUWHOXsfyPj5cJWL5WD8jxzd0YxO1yyKdr87eEq3LI58pwXm2U96rwOj-zMpFhFOi2QQGuRWgR9UDVQ1ug8Xzo1jBIFEpkmtW7Gb4SvsXsF8X4HasHsYxA-A95yRu2qzlb3Zc39DO8xsWMzAoGcwn7XDdcfzEu58KNWDpIzTyGEEt_5msAcUg-Fo2_c49VlRhO9LD8iZh2pAy4JT43wPCtHBLCRwUOUNPnKJHF.fV3Vhjqpt39X2RN3hpCf2Q/__results___files/__results___6_1.png)
















