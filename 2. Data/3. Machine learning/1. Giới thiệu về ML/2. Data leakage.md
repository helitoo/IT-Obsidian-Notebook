
**Tài liệu tham khảo**:
- https://www.kaggle.com/learn/intermediate-machine-learning.

**Data leakage** là hiện tượng training data chứa những thông tin liên quan đến kết quả (target). Data leakage khiến model dự đoán đúng hơn trên cả training set và testing set, nhưng sẽ giảm độ chính xác khi phát triển trong môi trường production.

# Target leakage

Xảy ra khi dữ liệu đầu vào chứa thông tin mà *ở thời điểm dự đoán chưa thể biết được*, nhưng lại có liên quan trực tiếp đến target.

**Nhận diện**: Tại thời điểm dự đoán, feature này có tồn tại hay đã được biết đến không?

**Biện pháp**: Loại bỏ các feature phát sinh sau thời điểm dự đoán.

![](https://storage.googleapis.com/kaggle-media/learn/images/y7hfTYe.png)

**VD**: Cho dataset khảo sát các bệnh nhân viêm phổi (*Pneumonia*) như sau:

| age | weight | male  | got_pneumonia | took_antibiotic_medicine | ... |
| --- | ------ | ----- | ------------- | ------------------------ | --- |
| 65  | 100    | False | False         | False                    | ... |
| 72  | 130    | True  | False         | False                    | ... |
| 58  | 100    | False | True          | True                     | ... |

Theo logic thực tế, sau khi người ta mắc bệnh (`got_pneumonia`) thì mới dùng thuốc kháng sinh (`took_antibiotic_medicine`), giữa `got_pneumonia` và `took_antibiotic_medicine` có tương quan rất cao, dễ khiến model nhầm tưởng là: *"Những ai dùng thuốc kháng sinh thì sẽ bị bệnh"* là mâu thuẫn với logic thực tế.

Biện pháp đơn giản nhất là loại bỏ feature `took_antibiotic_medicine` khỏi dataset.

# Train-Test contamination

Xảy ra khi dữ liệu của training set và testing set bị trộn lẫn vào nhau, model nhận được các thông tin từ cả testing set trong quá trình training.

**Biện pháp**: Tuyệt đối tuân theo các quy trình được đề ra tại [[1. Basic concepts]].
