
```insta-toc
---
title:
  name: Mục lục
  level: 1
  center: false
exclude: ""
style:
  listType: number
omit: []
levels:
  min: 1
  max: 6
---

# Mục lục

1. Các phương thức thống kê
2. Các hàm agreeate
3. Group by
```

Thực hiện tính `.min()`, `.meadian()`, `.mode()`, `.std()`, `.var()`, `.min()`, `.max()`, `.sum()` trên các field có kiểu dữ liệu số của `dtobj`. Tham số `include='all'` sẽ thực hiện tính toán trên các field có kiểu dữ liệu không phải số. 

# Các phương thức thống kê

```python
dtobj.value_counts()
```
Đếm tần suất của mỗi giá trị. Tham số `normalize=True` sẽ chuẩn hóa kết quả theo phân phối chuẩn.

```python
dtobj.quantile(val)
```
Trả về phân vị của `val` hoặc của các giá trị trong mảng `val`.

```python
dtobj.coor(method='pearson')
```
Trả về ma trận thể hiện độ tương quan giữa các field trong `dtobj` theo phương pháp Pearson.

# Các hàm agreeate

Một số hàm thường dùng:

| Hàm agreeate                              | Giá trị trả về                                                                                                                                                                        |
| ----------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `s.sum()`                                 | Tổng. Có thể dùng để đếm phần tử truth                                                                                                                                                |
| `s.mean()`                                | Trung bình.                                                                                                                                                                           |
| `s.median()`                              | Trung vị.                                                                                                                                                                             |
| `s.std()`                                 | Độ lệch chuẩn.                                                                                                                                                                        |
| `s.min()`                                 | Giá trị nhỏ nhất.<br>Tương tự với `s.max()`.                                                                                                                                          |
| `s.idxmin()`                              | Nhãn của giá trị nhỏ nhất.<br>- Khi gọi trên Series hàng -> Nhãn là tên index.<br>- Khi gọi trên Series cột -> Nhãn là tên cột.<br>Tương tự với `s.idxmax()`. Index có thể là `str`.  |
| `s.count()`                               | Số lượng phần tử khác `NaN`. Để đếm phần tử truth hãy dùng `s.sum()`.                                                                                                                 |
| `s.size()`                                | Số lượng phần tử.                                                                                                                                                                     |
| `s.unique()`                              | Các giá trị phân biệt nhau.                                                                                                                                                           |
| `s.value_counts()`                        | Tần suất xuất hiện các giá trị<br>Tương tự `.groupby().size()`.                                                                                                                       |
| `s.map(lambda r: f(r))`                   | Ánh xạ mỗi phần tử của Series qua `f(r)`.                                                                                                                                             |
| `dtobj.apply(f, axis='columns')`          | Áp dụng hàm `f` trên các cột của DataFrame, hàm `f` nhận tham số là 1 Series.<br>Tương tự với `rows`.                                                                                 |
| `dtobj.reset_index(drop=True)`            | Chuyển index cũ thành một cột thường (`drop=True`) và tạo index mới.<br>Trong trường hợp DataFrame đã group by, nó sẽ phân mảnh từng nhóm thành từng hàng như thể chưa từng group by. |
| `dtobj.set_index('c')`                    | Đưa cột `c` thành index.                                                                                                                                                              |
| `s.sort_index(ascending=True)`            | Sắp xếp index.                                                                                                                                                                        |
| `dtobj.sort_values(by=*, ascending=True)` | Sắp xếp các Series. Có các tham số sau:<br>- `by` (`list`\|`str`): Các Series cần sắp xếp. Nếu `dtobj` là Series thì không có tham số này.                                            |

Ngoài ra, các phép toán `+`, `-`, `*`,... có thể thực hiện trực tiếp với từng cột. Những toán tử này nhanh hơn các hàm trên vì chúng có sẵn trong Python.

Để sử dụng các hàm agreeate (`sum`), có 3 cách:

*Cách 1*: Sử dụng đơn lẻ.
```python
dtobj.sum() # Tạo 1 cột mới có tên là Sum
```

*Cách 2*: Sử dụng hàng loạt.
```python
dtobj.agg('sum') # Hoặc dtobj.agg(sum)
dtobj.agg(['sum', 'mean', 'median'])
```

*Cách 3*: Sử dụng có chọn lọc:
```python
dtobj.agg({
	'colA': 'sum',
	'colB': ['mean', 'median']
})
```

# Group by

Pandas có hỗ trợ **`.groupby(...)`** tương tự SQL `GROUP BY`. Các cột được group by sẽ trở thành index mới => Có thể cần `dtobj.reset_index()` hỗ trợ.

Thứ tự sử dụng: `.groupby()` -> Chọn cột -> `.agg()`...

>[!note] Các aggreation sau có hành vi đặc biệt trong group by
>- `.count()` và `.size()` thì không cần chọn cột để thực thi.
>- `.count()` trả về Series nếu có chọn cột hoặc trả về DataFrame nếu không chọn cột.
>- `.size()` trả về Series.

VD:
```python
reviews.groupby('points').price.min()
```


