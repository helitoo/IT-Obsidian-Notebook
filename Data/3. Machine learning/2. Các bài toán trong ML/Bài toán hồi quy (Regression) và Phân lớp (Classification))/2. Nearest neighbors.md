
```insta-toc
---
title:
  name: Mục lục
  level: 1
  center: false
exclude: ""
style:
  listType: number
omit: []
levels:
  min: 1
  max: 6
---

# Mục lục

1. Tổng quan
2. Một số tham số chung của NN
3. Một số dạng của NN
    1. sklearn.neighbors.KNeighborsClassifier
```


# Tổng quan

**Nearest neighbors (NN, KNN)** là một model *supervised* lẫn *unsupervised*. Trong đó, *unsupervised NN* là nền tảng xây dựng rất nhiều model quan trọng, như manifold learning và spectral clustering.

Ý tưởng của NN là phân loại 1 điểm dữ liệu (**labeling**) dựa trên label của $k$ điểm gần nhất với nó, nói cách khác là dựa trên mật độ label của các điểm lân cận nó. Trong trường hợp các điểm có label khác nhau nhưng khoảng cách tới điểm đang xét là như nhau, thuật toán sẽ chọn điểm có thứ tự cao hơn.

VD: 3NN trong phân loại 2 label:
![](https://upload.wikimedia.org/wikipedia/commons/7/78/KNN_decision_surface_animation.gif)

NN là thuật toán **non-generalizing / non-parametric** bởi vì mỗi điểm được labeling bởi ngay các hàng xóm của nó, chứ nội bộ thuật toán thì không học được gì. Cho nên NN không làm nảy sinh các vấn đề về trọng số như các model khác.

# Một số tham số chung của NN

**`n_neighbors`**: Số lượng điểm hàng xóm sẽ xét.

**`algorithm`**: Thuật toán thực hiện NN. Việc duyệt toàn bộ $n$ điểm, ở mỗi điểm lại duyệt thêm $n$ điểm nữa, từ đó chọn ra $k$ điểm gần nhất,... là một công việc có độ phức tạp rất lớn. Cho nên cần các thuật toán đặc biệt để xử lý:
- `'ball_tree'`: Sử dụng *Ball-tree*, tối ưu cho các distance ngay từ đầu, khá nhẹ và nhanh. Khi khoảng cách giữa các điểm tương tự nhau thì sẽ chậm hơn K-D-tree.
- `'kd_tree'`: Sử dụng *K-dimensional-tree*, hỗ trợ tốt cho Eucledian và Manhattan distance nhưng khá nặng.
- `'brute'`: Brute-force.
- `'auto'`: Sklearn tự tìm một chiến lược tối ưu.

**`leaf_size`**: Hiệu chỉnh hình dạng, hiệu năng của cây. Thường thì `30` đã là hợp lý.

**`metric`**: Phép đo khoảng cách giữa 2 điểm.
- `'minkowski'`: Norm bậc `p`.
- `'eucledian'` | `'l2'`: Thông dụng nhất, là đường thẳng nối giữa 2 điểm.
- `'manhattan'` | `'cityblock'` | `'l1'`: Là khoảng cách giữa 2 điểm khi chiếu lên lưới tọa độ.
- `'haversine'`: Khoảng cách giữa 2 điểm trên mặt cong.
- `'cosine'`: Góc giữa 2 điểm (vector). Thường áp dụng cho những feature phi hình học như tần suất, embedding vector,...

# Một số dạng của NN

## sklearn.neighbors.KNeighborsClassifier






























