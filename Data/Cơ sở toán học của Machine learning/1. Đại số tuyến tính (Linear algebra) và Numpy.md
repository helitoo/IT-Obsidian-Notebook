
```insta-toc
---
title:
  name: Mục lục
  level: 1
  center: false
exclude: ""
style:
  listType: number
omit: []
levels:
  min: 1
  max: 6
---

# Mục lục

1. Ma trận (Matrix, Array)
2. Các phép toán cơ bản trên ma trận
    1. Phép chuyển vị (Transpose)
    2. Phép chuyển vị liên hợp Hermitian
    3. Phép nhân thông thường (Dot product)
    4. Phép nhân Hadamard (Hadamard product)
    5. Ma trận nghịch đảo (Inverse matrix)
    6. Giải hệ phương trình tuyến tính
    7. Ma trận giả nghịch đảo (Moore-Penrose pseudoinverse matrix)
3. Định thức (Determinant)
4. Tổ hợp tuyến tính, Không gian sinh
    1. Tổ hợp tuyến tính (Linear combination)
    2. Cơ sở (Base, Basis)
    3. Hệ trực chuẩn (Orthogonal), ma trận trực giao (Orthonormal)
    4. Biễu diễn vector trong các hệ cơ sở khác nhau
    5. Hạng (Rank)
5. Trị riêng, Vector riêng, Chéo hóa ma trận
    1. Trị riêng (Eigenvectors), Vector riêng (Eigenvalues)
    2. Chéo hóa ma trận (Diagonalization, Eigendecomposition)
6. Ma trận (nửa) xác định dương (Positive (semi)definite, PD - PSD)
7. Chuẩn (Norm)
    1. Định nghĩa norm
    2. Đối với vector: $lp$ norm
    3. Đối với ma trận: Frobenius norm
    4. Vết (trace)
```

Giả sử các đoạn mã sau đều đã được `import` thư viện Numpy:
```python
import numpy as np
```

# Ma trận (Matrix, Array)

Ma trận $A_{m \times n}$ là một bộ số có $m$ hàng và $n$ cột.
- Mỗi hàng của $A$ là một vector hàng.
- Mỗi cột của $A$ là một vector cột.
- $a_i$ là vector cột thứ $i$ của ma trận $A$.
- $a_{ij}$ là phần tử ở hàng $i$, cột $i$ của ma trận $A$.

VD: Cho ma trận:
$$ A =
\begin{bmatrix}
	a & b\\
	c & d\\
	e & f
\end{bmatrix}
$$
Trong đó:
- $A_0 = x_0 = [a; c; e]$ là một vector cột của $A$.
- $A_{:,0} = y_0 =[a, b]$ là một vector hàng của $A$.

Trong NumPy, ma trận được biểu diễn bằng `numpy.array`, `numpy.matrix` (ít dùng hơn) hoặc đơn giản nhất là **không dùng gì cả**.
```python
A = np.array([[a, b], [c, d], [e, f]]) # A = [[a, b], [c, d], [e, f]]
print(A.shape) # (3, 2)
```
Trong đó:
- `A[0,:]`: $A_0$.
- `A[:,0]`: $A_{:,0}$.

Có 1 số loại ma trận đặc biệt như:

**Ma trận đơn vị / Hệ cơ sở / Hệ chính tắc** ($I_n$): Là ma trận vuông bận $n$ mà đường chéo chính bằng 1, các phần tử còn lại bằng 0.
```python
print(np.eye(3))
```
```sh
[[1. 0. 0.]
 [0. 1. 0.]
 [0. 0. 1.]]
```

**Ma trận đường chéo**: Là ma trận mà đường chéo khác 0.
```python
print(np.diag([1,2,3]))
```
```sh
[[1 0 0]
 [0 2 0]
 [0 0 3]]
```

# Các phép toán cơ bản trên ma trận

## Phép chuyển vị (Transpose)

$A^T$ là ma trận chuyển vị của $A$ nếu $a^T_{ij}=a_{ji}$.
Nếu $A^T=A$ thì $A$ là **ma trận đối xứng (Symmetric matrix)**.

VD:
```python
A = np.array([[1,2,3]])
print(A.T)
```
```sh
[[1]
 [2]
 [3]]
```

## Phép chuyển vị liên hợp Hermitian

Số phức $z = a + bi$ có liên hợp là $\overline{z} = a - bi$.

$A^H$ là ma trận chuyển vị của $A$, đồng thời, mỗi phần tử của $A$ thực hiện liên hợp. Phép vừa chuyển vị vừa liên hợp gọi là **phép Hermitian**.

VD:
```python
A = np.array([[1+2j, 3+4j]])
print(A.conj().T)
```
```sh
[[1.-2.j]
 [3.-4.j]]
```

## Phép nhân thông thường (Dot product)

Cho 2 ma trận $A, B$ sao cho số cột của ma trận này bằng số hàng của ma trận kia:
$$\boxed{ A.B=C; \quad c_{ij} = \sum_{k=1}^{n} a_{ik} b_{kj}; \quad \forall \; 1 \leq i \leq m, \; 1 \leq j \leq p }$$

Một số tính chất:
1. Muốn nhân 2 ma trận, số hàng của ma trận này bằng số cột của ma trận kia.
2. Phân phối đối với tổng: $A(B+C) = AB + AC$.
3. Phân phối đối với chuyển vị: $(AB)^T = A^T.B^T$. Tương tự với phép Hermitian.
4. Phép nhân với ma trận đơn vị không làm thay đổi ma trận ban đầu: $A.I=A$.

VD:
```python
A = np.array([[1,2],[3,4],[5,6]])
B = np.array([[1,2,3],[4,5,6]])

C = np.dot(A, B) # hoặc A.dot(B), hoặc np.matmul(A, B), hoặc A @ B

print(A)
```
```sh
[[1 2]
 [3 4]
 [5 6]]
```

## Phép nhân Hadamard (Hadamard product)

Nếu $A$ và $B$ cùng kích thước thì:
$$\boxed{ A \circ B = C; \quad c_{ij} = a_{ij} . b_{ij} }$$

```python
A = np.array([[1,2],[3,4]])
B = np.array([[5,6],[7,8]])

C = A * B

print(A)
```
```sh
[[1 2]
 [3 4]]
```

## Ma trận nghịch đảo (Inverse matrix)

Cho ma trận $A$, nếu tồn tại ma trận vuông $A^{-1}$ sao cho $\boxed{A.A^{-1}=I}$ thì:
- $A$ **khả nghịch (invertible, nonsingular, nondegenerate)**.
- $A^{-1}$ là ma trận **nghịch đảo**.

Tính chất:
1. Giao hoán: $A^{-1}.A = A.A^{-1} = I$.
2. Phân phối đối với tính khả nghịch: Nếu $A, B$ khả nghịch thì $A.B$ và $A^{-1}.B^{-1}$ cũng khả nghịch.
3. Ma trận $A$ khả nghịch khi
	1. $\det{A} \neq 0$ hay
	2. $\text{rank}(A_{m \times n}) = n$ hay
	3. $A^{-1} = (X.\Lambda.X^{-1})^{-1} = X.\Lambda^{-1}.X^{-1}$.
4. Nếu ma trận $A$ khả nghịch thì $\det{(A^{-1})} = \frac{1}{\det{A}}$.

VD:
```python
A = np.array([[1,2],[3,4]])
A_inv = np.linalg.inv(A)

print(A_inv)
```
```sh
[[-2.   1. ]
 [ 1.5 -0.5]]
```

## Giải hệ phương trình tuyến tính

Giả sử có hệ phương trình tuyến tính $Ax = B$, khi đó, $\boxed{x = A^{-1}B}$.
$$
\begin{align}
	Ax=b&\Leftrightarrow
	\begin{bmatrix}
		a_{00}&a_{01}&...&a_{0n}\\
		a_{10}&a_{11}&...&a_{0n}\\
		...&...&...&...\\
		a_{m0}&a_{01}&...&a_{mn}\\
	\end{bmatrix}
	\begin{bmatrix}
		x_0&x_1&...&x_n
	\end{bmatrix}
	=
	\begin{bmatrix}
		b_0\\
		b_1\\
		...\\
		b_m
	\end{bmatrix}\\
	&\Leftrightarrow
	\begin{cases}
		a_{00}x_0+a_{01}x_1+...a_{0n}x_n&=b_0\\
		...\\
		a_{m0}x_0+a_{m1}x_1+...a_{mn}x_n&=b_m\\
	\end{cases}\\
	&\Leftrightarrow
	x=A^{-1}B
\end{align}
$$

VD:
```python
A = np.array([[2, 1],[1, -1]])
b = np.array([5, 1])
x = np.dot(np.linalg.inv(A), b) # x = np.linalg.solve(A, b)

print(x)
```
```sh
[2. 1.]
```

## Ma trận giả nghịch đảo (Moore-Penrose pseudoinverse matrix)

Ma trận giả nghịch đảo áp dụng trên mọi loại ma trận, ký hiệu $A^+$, được định nghĩa là:
- $AA^+A=A$.
- $A^+AA^+=A^+$.
- $(AA^+)^T=AA^+$.
- $(A^+A)^T=A^+A$.
- Nếu $A$ khả nghịch thì $A^+=A^{-1}$.

**Phép phân tích giá trị kỳ dị (SVD)**: Giả sử $A=U_m\Sigma_{m \times n}V_n^T$, trong đó:
- $U, V$ là ma trận trực chuẩn.
- $\Sigma$ là ma trận đường chéo, mỗi $\sigma_{ii} = \sqrt{\lambda_i}$ được gọi là một giá trị kỳ dị.

Với $$\Sigma^+=\Sigma^{-1};\quad \sigma^+_{ii}=\sigma_{ii}$$
Ma trận giả nghịch đảo được tính bằng:
$$A^+ = V\Sigma^+U^T$$

# Định thức (Determinant)

Định thức của ma trận vuông $A$, ký hiệu $\det{A}$ hoặc $|A|$, được tính theo công thức khai triển Laplace:
1. $\det{A} = \sum_{j=1}^{n} (-1)^{i+j} \, a_{ij} \, M_{ij}$.
2. $\det{A} = \sum_{i=1}^{n} (-1)^{i+j} \, a_{ij} \, M_{ij}$.

Trong đó:
- **Định thức con (Minor)**:
	- Gọi $A_{ij}$ là ma trận con của $A$ bằng cách bỏ đi hàng $i$ cột $j$ của $A$.
	- Ký hiệu $M_{ij}=\det{A_{ij}}$.

- **Định thức con chính (Principle minor)**:
	- Là một dạng ngược lại của minor.
	- Gọi $\mathcal{I}$ là tập hợp các cột/hàng cần giữ lại của ma trận con.
	- Ký hiệu $\det{A_{\mathcal{I}}}$.
	- VD: $\mathcal{I}=\{1, 3\}$, tức là giữa lại hàng/cột 1 và 3.

- **Định thức con chính đầu (Leading principle minor)**:
	- Là một dạng mở rộng của principle minor, thay vì liệt kê các hàng/cột trong $\mathcal{I}$, $\mathcal{I}$ chỉ chứa $n$ hàng/cột đầu tiên.
	- Ký hiệu $\det{A_{\mathcal{I}}}$.


Tính chất:
1. $\det{I}=1$.
2. $\det{a_{ij}} = a_{ij}$.
3. $\det{A} = \det{A^T}$.
4. $\det{(A.B)} = \det{A}.\det{B}$.
5. Định thức của ma trận vuông là tích đường chéo của nó.
6. Nếu trong ma trận có hàng hoặc cột bằng 0 thì định thức của nó bằng 0.

VD:
```python
A = np.array([[1,2],[3,4]])
det = np.linalg.det(A)

print(det)
```
```sh
-2.0000000000000004
```

# Tổ hợp tuyến tính, Không gian sinh

## Tổ hợp tuyến tính (Linear combination)

Cho $n$ vector $a_i \in \mathbb{R}^m$ và vector $x \in \mathbb{R}^n$ là bộ các số thực. Biểu thức $b$ được gọi là **tổ hợp tuyến tính**:
$$ b = x_1.a_1 + x_2.a_2 + ... + x_n.a_n $$

Nếu ghép các vector $a_i$ lại thành ma trận $A = [a_1; a_2; ...; a_n] \in \mathbb{R}^{n \times m}$ và xét vector cột $x^T$ thì $b$ được gọi là **tổ hợp tuyến tính các cột** của $A$.

**Không gian sinh (Span space)**, ký hiệu $\text{span}{(a_1; a_2; ...; a_n)}$ là ma trận sao cho một số vector đều có thể biểu diễn qua một bộ số $x$ bất kỳ với các cột của ma trận đó (tổ hợp tuyến tính).

Xét tổ hợp tuyến tính $b$:
- Nếu $x_1 = x_2 = ... = x_n = 0$ thì hệ các vector $a_i$ là **độc lập tuyến tính (linear independence)**.
- Ngược lại là **phụ thuộc tuyến tính**.

Tính chất:
1. Một hệ phụ thuộc nếu có vector trong hệ đó là tổ hợp tuyến tính của các vector còn lại trong hệ.
2. Tập con khác rỗng của một hệ độc lập cũng độc lập.
3. Tập các cột của ma trận khả nghịch là độc lập.

## Cơ sở (Base, Basis)

Ma trận $A = [a_1; a_2; ...; a_n] \in \mathbb{R}^{n \times n}$ được gọi là **cơ sở** nếu các vector cột của nó là **không gian sinh và độc lập tuyến tính**. Khi đó, một số vector đều có thể được biểu diễn qua một bộ số $x$ duy nhất với các vector cột của $A$ (tổ hợp tuyến tính).

Với mỗi ma trận $A \in \mathbb{R}^{m \times n}$ đều có 2 không gian con quan trọng sau:
1. **Range** của $A$ ($\mathcal{R}(A)$) là không gian sinh các cột của $A$, hay là tập hợp các điểm tổ hợp tuyến tính các cột của $A$.
2. **Null (Không gian nghiệp)** của $A$ ($\mathcal{N}(A)$) là bộ số làm cho tổ hợp tuyến tính các cột của $A$ thành 0.

## Hệ trực chuẩn (Orthogonal), ma trận trực giao (Orthonormal)

Ma trận $A = [a_1; a_2; ...; a_n] \in \mathbb{R}^{n \times n}$ được gọi là **trực giao** nếu mỗi vector cột của nó khác 0 nhưng tích 2 vector cột bất kỳ bằng 0.

Ma trận $A = [a_1; a_2; ...; a_n] \in \mathbb{R}^{n \times n}$ được gọi là **trực chuẩn** nếu nó là trực giao và mỗi vector cột của nó có độ dài là 1.

Tính chất:
1. Nếu hệ $A$ trực chuẩn thì $A.A^T = A^T.A = I_n$. Nếu $A.A^H = A^H.A = I_n$ thì $A$ được gọi là **ma trận Unitary**.
2. Nếu hệ $A$ trực giao thì $A^T = A^{-1}$. Và $A^T$ cũng là hệ trực giao.
3. Nếu hệ $A$ trực giao thì $\det{A} = \pm 1$.

## Biễu diễn vector trong các hệ cơ sở khác nhau

Vector $x$ có thể được biểu diễn qua hệ cơ sở $A_n = [a_1; a_2; ...; a_n]$ thành vector $y$ theo công thức:
$$ y = x_1.a_1 + x_2.a_2 + ... + x_n.a_n = x.A^T = x.A^{-1} $$
Với mỗi $x$ thì $y$ là duy nhất.

Tính chất:
- Mọi vector có thể được biểu diễn qua hệ cơ sở chính tắc $I_n$.
- Vector 0 là như nhau khi biểu diễn qua mọi hệ cơ sở.

## Hạng (Rank)

Hạng của ma trận $A$ ($\text{rank}(A)$) là số lượng lớn nhất các cột của ma trận đó tạo thành hệ vector độc lập.

Tính chất:
1. Mọi ma trận khác 0 đều có hạng > 0.
2. $\text{rank}(A) = \text{rank}(A^T)$.
3. $\text{rank}(A_{m \times n}) \leq \min(m, n)$.
4. $\text{rank}(A+B) \leq \text{rank}(A) + \text{rank}{(B)}$.
5. Bất đẳng thức Sylvester: Cho $A_{m \times n}$ và $B_{n \times k}$, $\text{rank}(A) + \text{rank}{(B)} - n \leq \text{rank}(A.B)$.

# Trị riêng, Vector riêng, Chéo hóa ma trận

## Trị riêng (Eigenvectors), Vector riêng (Eigenvalues)

Cho một ma trận $A \in \mathbb{R}^{n \times n}$ và vector $x \in \mathbb{R}^n$. Nếu tồn tại một số vô hướng $\lambda$ sao cho $A.x = \lambda.x$, khi đó:
- $x$: vector riêng.
- $\lambda$: trị riêng.

Khi biến đổi phương trình trên, ta được $(A - \lambda.I).x = 0$, tức $x \in \mathcal{N}(A - \lambda.I)$ và $\det(A - \lambda.I) = 0$, đây được gọi là **phương trình đặc trưng (characteristic)**.
- Đa thức $p_A(\lambda) = \det(A - \lambda.I)$ là đa thức đặc trưng.
- Tập hợp tất cả các trị riêng được gọi là **phổ (Spectrum)**.

Tính chất:
1. Nếu $x$ là vector riêng thì $\alpha.x$ cũng là vector riêng.
2. Tất cả ma trận vuông đều có trị riêng $\lambda$.
3. Tích của các trị riêng của một ma trận bằng định thức của ma trận đó.
4. Tổng tất cả các trị riêng của một ma trận bằng tổng các phần tử trên đường chéo của ma trận đó.
5. Phổ của một ma trận bằng phổ của ma trận chuyển vị của nó.
6. Mặc dù phép nhân ma trận không giao hoán, nhưng $p_{AB}(\lambda) = p_{BA}(\lambda)$, tức là phổ của 2 tích này trùng nhau.
7. Trị riêng của ma trận Hermitian là số thực.
8. Nếu $(\lambda, x)$ là một cặp trị riêng, vector riêng của ma trận $A$ khả nghịch thì $(\lambda^{-1}, x)$ là cặp trị riêng, vector riêng của ma trận $A^{-1}$.

## Chéo hóa ma trận (Diagonalization, Eigendecomposition)

Diagonalization (chéo hóa ma trận) là quá trình biến đổi một ma trận vuông $A$ thành một ma trận chéo $\Lambda$ bằng cách sử dụng một ma trận khả nghịch $X$.

Gọi $X = [x_1, x_2, ..., x_n]$ là bộ các vector riêng ứng với $\Lambda = \text{diag}(\lambda_1, \lambda_2, ..., \lambda_n)$ là tập hợp các trị riêng của ma trận $A$. Khi đó, $A.X = X.\Lambda$.

Nếu $X$ độc lập tuyến tính và khả nghịch thì $A = X.\Lambda.X^{-1}$.

Tính chất:
1. Chéo hóa chỉ có thể thực hiện với ma trận vuông, nhưng không phải ma trận vuông nào cũng chéo hóa được. Ma trận vuông chỉ có thể chéo hóa khi nó có đủ $n$ trị riêng và $X$ độc lập tuyến tính.
2. Một ma trận có thể có nhiều cách chéo hóa. Chỉ cần đổi vị trí của các $\lambda_i$ và vị trí tương ứng các cột của $X$, ta sẽ có một cách chéo hoá mới.
3. Nếu $A$ chéo hóa được thì $A^k$ cũng chéo hóa được theo công thức $A^k = X.\Lambda^k.X^{-1}$.

# Ma trận (nửa) xác định dương (Positive (semi)definite, PD - PSD)

Xét ma trận $A_n$ và các vector $\forall x \in \mathbb{R}^n : x \neq 0$:
- $A$ là ma trận xác định dương khi $x^T.A.x>0$. Ký hiệu $A \succ 0$.
- $A$ là ma trận nửa xác định dương khi $x^T.A.x \geq 0$. Ký hiệu $A \succeq 0$.
- Tương tự với xác định âm ($A \prec 0$) và nửa xác định âm ($A \preceq 0$).
- Tương tự với ma trận Hermitian.

VD: Ma trận:
$$ A = 
\begin{bmatrix}
	1 & -1 \\
	-1 & 1
\end{bmatrix}
$$
là nửa xác định dương, vì:
$$
\forall x = 
\begin{bmatrix}
	u\\
	v
\end{bmatrix}
, \quad
x^T.A.x=
\begin{bmatrix}
	u & v
\end{bmatrix}
\begin{bmatrix}
	1 & -1 \\
	-1 & 1
\end{bmatrix}
\begin{bmatrix}
	u\\
	v
\end{bmatrix}
= u^2 + v^2 - 2uv = (u - v)^2 \geq 0
$$

Tính chất:
1. Mọi trị riêng của ma trận xác định dương đều là một số thực dương.
2. Định thức của ma trận xác định dương là dương, nên nó khả nghịch.
3. Mọi ma trận xác định dương là khả nghịch. Định thức của nó là dương.
4. **Tiêu chuẩn Sylvester**: Nếu một ma trận xác định dương, thì mọi leading principle minor (định thức con chính đầu) của nó cũng dương tương ứng. Tương tự với nửa xác định dương (không âm), xác định và nửa xác định âm.
5. $\forall B \in \mathbb{R}^{m \times n}, \quad A = B^H.H$ là nửa xác định dương.
6. **Khai triển Cholesky**: Mọi ma trận Hermitian nửa xác định dương $A$ đều có thể được triển khai thành $A = L.L^H$, trong đó $L$ là một ma trận tam giác dưới với nửa tam giác trên là số thực dương.
7. Nếu $A$ là ma trận nửa xác định dương thì $x^T.A.x = 0 \Leftrightarrow A.x = 0$.

# Chuẩn (Norm)

## Định nghĩa norm

Norm là hàm độ dài của vector / ma trận. Một hàm số $f : \mathbb{R}^n \rightarrow \mathbb{R}$ là norm khi thỏa mãn 3 điều sau:
1. $f(x) \geq 0, \quad f(0) = 0$.
2. $f(\alpha.x) = |\alpha|.f(x)$.
3. $f(x_1) + f(x_2) \geq f(x_1 + x_2)$ (bất đẳng thức tam giác).

Ký hiệu: Norm của vector $x$ là $\|x\|$.

## Đối với vector: $l_p$ norm

$l_p$ norm có công thức tổng quát:
$$ \|x\|_p = \left( \sum |x_i|^p \right)^{\frac{1}{p}} $$
Một vài trường hợp đặc biệt của $p$:
1. Khi $p=1$, ta có $l_1$ norm, còn được gọi là **Manhattan norm** (khoảng cách taxicab): Là độ dài khi chiếu vector lên trục tọa độ.
2. Khi $p=2$, ta có $l_2$ norm, còn được gọi là **Eucledian norm** (khoảng cách đường chim bay): Là độ dài thực của vector đó.

## Đối với ma trận: Frobenius norm

Là căn bậc 2 của tổng các bình phương phần tử của ma trận đó:
$$ \|A_{m \times n}\|_F = \sqrt { \sum_{i=1}^m \sum_{j=1}^n a_{ij}^2 } $$

## Vết (trace)

Vết của ma trận $A$ (ký hiệu $\text{trace}(A)$) là:
- Tổng các phần tử trên đường chéo chính của nó.
- Tổng các trị riêng của nó.

Tính chất:
1. $\text{trace}(A) = \text{trace}(A^T)$.
2. $\text{trace}(\sum_{i=1}^m (A_i)) = \sum_{i=1}^m (\text{trace}(A_i))$.
3. $\text{trace}(k.A) = k.\text{trace}(A)$.
4. $\text{trace}(AB) = \text{trace}(BA); \quad \text{trace}(ABC) = \text{trace}(CBA)$.
5. $\text{trace}(X.A.X^{-1}) = \text{trace}(X^{-1}.A.X) = \text{trace}(A)$.
6. $\|A\|_F^2 = \text{trace}(A^T.A) = \text{trace}(A.A^T) \quad \Rightarrow \quad \text{trace}(A.A^T) \geq 0$.
